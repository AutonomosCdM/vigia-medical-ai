# VIGIA Medical AI - Critical User Flow

## Objetivo
El happy path más importante: paciente envía imagen médica por WhatsApp → análisis AI de 9 agentes → equipo médico recibe resultados por Slack → respuesta al paciente.

## Código Eraser.io
```
autoNumber on
colorMode bold

// Actors
Patient [icon: user, color: blue]  
WhatsApp_Bot [icon: mobile, color: green]
PHI_Tokenizer [icon: shield, color: red]
Master_Orchestrator [icon: hub, color: purple]
Medical_Agents [icon: users, color: blue]
MONAI_Engine [icon: brain, color: green]
Medical_Team [icon: users, color: orange]
Slack_Bot [icon: slack, color: purple]

// Phase 1: Patient Input & PHI Tokenization
Patient > WhatsApp_Bot: "🖼️ Pressure ulcer image\n📝 MRN: BW-2025-001"
activate WhatsApp_Bot
WhatsApp_Bot > PHI_Tokenizer: "Patient data validation"
activate PHI_Tokenizer
PHI_Tokenizer > PHI_Tokenizer: "Bruce Wayne → Batman token\nbatman_TC001_abc123"
PHI_Tokenizer > WhatsApp_Bot: "✅ Token created\n⏱️ 15min session"
deactivate PHI_Tokenizer
WhatsApp_Bot > Patient: "✅ Image received\n🔄 Medical analysis starting..."
deactivate WhatsApp_Bot

// Phase 2: Medical Orchestration
activate Master_Orchestrator
Master_Orchestrator > Medical_Agents: "🚀 Coordinate 9-agent analysis\n🏥 Priority: URGENT"
activate Medical_Agents

// Parallel Medical Analysis
par [label: "Multi-Agent Medical Analysis"] {
  Medical_Agents > MONAI_Engine: "🔬 Primary medical imaging analysis"
  activate MONAI_Engine
  MONAI_Engine > Medical_Agents: "📊 MONAI: Grade 4 LPP detected\n🎯 Confidence: 94%"
  deactivate MONAI_Engine
}
and {
  Medical_Agents > Medical_Agents: "🩺 Clinical assessment\n⚠️ Risk factors analysis"
}
and {
  Medical_Agents > Medical_Agents: "📋 NPUAP protocol review\n📖 Evidence-based recommendations"
}

Medical_Agents > Master_Orchestrator: "🚨 CRITICAL: Grade 4 LPP\n⏰ Urgent surgical evaluation required"
deactivate Medical_Agents
deactivate Master_Orchestrator

// Phase 3: Medical Team Communication
activate Slack_Bot
Slack_Bot > Medical_Team: "🚨 URGENT MEDICAL ALERT\n👤 Patient: batman_TC001\n📊 Grade 4 LPP detected\n🎯 Confidence: 94%\n⏰ Response needed: <15min"
activate Medical_Team
Medical_Team > Slack_Bot: "✅ Dr. Smith reviewing\n📞 Contacting patient now"
deactivate Medical_Team
Slack_Bot > Master_Orchestrator: "✅ Medical team notified\n👨‍⚕️ Dr. Smith responding"
deactivate Slack_Bot

// Phase 4: Patient Response
activate WhatsApp_Bot
WhatsApp_Bot > Patient: "🏥 URGENT MEDICAL ALERT\n📊 Grade 4 pressure injury detected\n👨‍⚕️ Dr. Smith will contact you\n📞 Call: (555) 123-4567\n⏰ Immediate evaluation required"
Patient > WhatsApp_Bot: "✅ Understood, thank you"
WhatsApp_Bot > Patient: "🔄 Medical case logged\n📋 Reference: batman_TC001"
deactivate WhatsApp_Bot

// Audit Trail
note over PHI_Tokenizer, Slack_Bot: "📝 Complete audit trail maintained\n🔒 HIPAA compliance verified\n⏱️ Total response time: <3 minutes"
```

## Notas Clave
- **Sub-3 minutos**: Tiempo total desde imagen hasta alerta médica crítica
- **9 Agentes Coordinados**: Análisis médico paralelo con Master Orchestrator
- **NPUAP Grade 4**: Detección automática de lesiones críticas que requieren cirugía urgente
- **Comunicación Bidireccional**: WhatsApp paciente ↔ Slack equipo médico con audit completo

## Para Editar
1. Copia el código anterior
2. Ve a [eraser.io](https://eraser.io)
3. Crea nuevo diagrama → Diagram-as-code
4. Pega el código y edita