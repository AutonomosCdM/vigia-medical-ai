# VIGIA Medical AI - Critical User Flow

## Objetivo
El happy path mÃ¡s importante: paciente envÃ­a imagen mÃ©dica por WhatsApp â†’ anÃ¡lisis AI de 9 agentes â†’ equipo mÃ©dico recibe resultados por Slack â†’ respuesta al paciente.

## CÃ³digo Eraser.io
```
autoNumber on
colorMode bold

// Actors
Patient [icon: user, color: blue]  
WhatsApp_Bot [icon: mobile, color: green]
PHI_Tokenizer [icon: shield, color: red]
Master_Orchestrator [icon: hub, color: purple]
Medical_Agents [icon: users, color: blue]
MONAI_Engine [icon: brain, color: green]
Medical_Team [icon: users, color: orange]
Slack_Bot [icon: slack, color: purple]

// Phase 1: Patient Input & PHI Tokenization
Patient > WhatsApp_Bot: "ğŸ–¼ï¸ Pressure ulcer image\nğŸ“ MRN: BW-2025-001"
activate WhatsApp_Bot
WhatsApp_Bot > PHI_Tokenizer: "Patient data validation"
activate PHI_Tokenizer
PHI_Tokenizer > PHI_Tokenizer: "Bruce Wayne â†’ Batman token\nbatman_TC001_abc123"
PHI_Tokenizer > WhatsApp_Bot: "âœ… Token created\nâ±ï¸ 15min session"
deactivate PHI_Tokenizer
WhatsApp_Bot > Patient: "âœ… Image received\nğŸ”„ Medical analysis starting..."
deactivate WhatsApp_Bot

// Phase 2: Medical Orchestration
activate Master_Orchestrator
Master_Orchestrator > Medical_Agents: "ğŸš€ Coordinate 9-agent analysis\nğŸ¥ Priority: URGENT"
activate Medical_Agents

// Parallel Medical Analysis
par [label: "Multi-Agent Medical Analysis"] {
  Medical_Agents > MONAI_Engine: "ğŸ”¬ Primary medical imaging analysis"
  activate MONAI_Engine
  MONAI_Engine > Medical_Agents: "ğŸ“Š MONAI: Grade 4 LPP detected\nğŸ¯ Confidence: 94%"
  deactivate MONAI_Engine
}
and {
  Medical_Agents > Medical_Agents: "ğŸ©º Clinical assessment\nâš ï¸ Risk factors analysis"
}
and {
  Medical_Agents > Medical_Agents: "ğŸ“‹ NPUAP protocol review\nğŸ“– Evidence-based recommendations"
}

Medical_Agents > Master_Orchestrator: "ğŸš¨ CRITICAL: Grade 4 LPP\nâ° Urgent surgical evaluation required"
deactivate Medical_Agents
deactivate Master_Orchestrator

// Phase 3: Medical Team Communication
activate Slack_Bot
Slack_Bot > Medical_Team: "ğŸš¨ URGENT MEDICAL ALERT\nğŸ‘¤ Patient: batman_TC001\nğŸ“Š Grade 4 LPP detected\nğŸ¯ Confidence: 94%\nâ° Response needed: <15min"
activate Medical_Team
Medical_Team > Slack_Bot: "âœ… Dr. Smith reviewing\nğŸ“ Contacting patient now"
deactivate Medical_Team
Slack_Bot > Master_Orchestrator: "âœ… Medical team notified\nğŸ‘¨â€âš•ï¸ Dr. Smith responding"
deactivate Slack_Bot

// Phase 4: Patient Response
activate WhatsApp_Bot
WhatsApp_Bot > Patient: "ğŸ¥ URGENT MEDICAL ALERT\nğŸ“Š Grade 4 pressure injury detected\nğŸ‘¨â€âš•ï¸ Dr. Smith will contact you\nğŸ“ Call: (555) 123-4567\nâ° Immediate evaluation required"
Patient > WhatsApp_Bot: "âœ… Understood, thank you"
WhatsApp_Bot > Patient: "ğŸ”„ Medical case logged\nğŸ“‹ Reference: batman_TC001"
deactivate WhatsApp_Bot

// Audit Trail
note over PHI_Tokenizer, Slack_Bot: "ğŸ“ Complete audit trail maintained\nğŸ”’ HIPAA compliance verified\nâ±ï¸ Total response time: <3 minutes"
```

## Notas Clave
- **Sub-3 minutos**: Tiempo total desde imagen hasta alerta mÃ©dica crÃ­tica
- **9 Agentes Coordinados**: AnÃ¡lisis mÃ©dico paralelo con Master Orchestrator
- **NPUAP Grade 4**: DetecciÃ³n automÃ¡tica de lesiones crÃ­ticas que requieren cirugÃ­a urgente
- **ComunicaciÃ³n Bidireccional**: WhatsApp paciente â†” Slack equipo mÃ©dico con audit completo

## Para Editar
1. Copia el cÃ³digo anterior
2. Ve a [eraser.io](https://eraser.io)
3. Crea nuevo diagrama â†’ Diagram-as-code
4. Pega el cÃ³digo y edita